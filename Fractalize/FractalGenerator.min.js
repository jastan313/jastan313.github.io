function Complex(e,t){this.real=e,this.imaginary=t,this.str=""+e}function Polynomial(e,t,o){this.nTerms=e,this.coef=new Array(e),this.pow=new Array(e);for(var n=0;n<e;n++)this.coef[n]=t[n],this.pow[n]=o[n]}function fractalLoading(e){create_link_button_text.innerHTML=e,create_link_button_text.classList.add("div_disabled"),create_link_button.classList.add("div_disabled")}function fractalUnload(e){create_link_button_text.innerHTML=e,create_link_button_text.classList.remove("div_disabled"),create_link_button.classList.remove("div_disabled")}function fractalLoaded(e){create_link_button_text.style.opacity=0,setTimeout(function(){create_link_button_text.style.color="#990000",fractalUnload(e),create_link_button_text.style.opacity=100},550)}function debounce(e,t,o){var n=null,a=[];return function(){if(fractalLoading("LOADING..."),o){for(var r=[],l=0;l<arguments.length;++l)r.push(arguments[l]);a.push(r)}n&&clearTimeout(n);var i=arguments;n=setTimeout(function(){t.apply(o?{data:a}:null,i),a=[],n=null},e)}}function getURLParameter(e){var t=window.location.href;e=e.replace(/[\[\]]/g,"\\$&");var o=new RegExp("[?&]"+e+"(=([^&#]*)|&|#|$)").exec(t);return o?o[2]?decodeURIComponent(o[2].replace(/\+/g," ")):"":null}function moveCanvas(e){var t=parseFloat(e.clientX)-parseFloat(clickX),o=parseFloat(e.clientY)-parseFloat(clickY),n=parseFloat(1/zoom);canvasX=parseFloat(canvasX)+parseFloat(n*t),canvasY=parseFloat(canvasY)+parseFloat(n*o),canvasX.toFixed(10),canvasY.toFixed(10),clickX=parseFloat(e.clientX),clickY=parseFloat(e.clientY)}function zoomCanvas(e){var t=10+.058827625*zoom+9.25943e-11*zoom*zoom;(zoom=parseFloat(zoom)+parseFloat(t*e)).toFixed(5),zoom<=5&&(zoom=5)}function componentToHex(e){var t=e.toString(16);return 1===t.length?"0"+t:t}function rgbToHex(e,t,o){return"#"+componentToHex(e)+componentToHex(t)+componentToHex(o)}function hexToRGB(e){var t=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e);return t?{r:parseInt(t[1],16),g:parseInt(t[2],16),b:parseInt(t[3],16)}:null}function gradientColorConversion(e,t,o){var n=hexToRGB(e),a=hexToRGB(t),r=a.r-n.r,l=a.g-n.g,i=a.b-n.b;return rgbToHex(parseInt(n.r+r*o),parseInt(n.g+l*o),parseInt(n.b+i*o))}function chooseColor(e){return 0===e?color1_opt.value:e<=.25?gradientColorConversion(color1_opt.value,color2_opt.value,4*e):e<=.5?gradientColorConversion(color2_opt.value,color3_opt.value,4*(e-.25)):e<=.75?gradientColorConversion(color3_opt.value,color4_opt.value,4*(e-.5)):gradientColorConversion(color4_opt.value,color5_opt.value,4*(e-.75))}function selectDefaults(){switch(type_opt.value){case fractalOption.MANDELBROT_SET:canvasX=mandelbrotSetDefault.CANVAS_X,canvasY=mandelbrotSetDefault.CANVAS_Y,zoom=mandelbrotSetDefault.ZOOM,iterations_opt.value=mandelbrotSetDefault.ITERATIONS;break;case fractalOption.BURNING_SHIP:canvasX=burningShipDefault.CANVAS_X,canvasY=burningShipDefault.CANVAS_Y,zoom=burningShipDefault.ZOOM,iterations_opt.value=burningShipDefault.ITERATIONS;break;case fractalOption.JULIET_SET:canvasX=julietSetDefault.CANVAS_X,canvasY=julietSetDefault.CANVAS_Y,zoom=julietSetDefault.ZOOM,iterations_opt.value=julietSetDefault.ITERATIONS;break;case fractalOption.LYAPUNOV:canvasX=lyapunovDefault.CANVAS_X,canvasY=lyapunovDefault.CANVAS_Y,zoom=lyapunovDefault.ZOOM,iterations_opt.value=lyapunovDefault.ITERATIONS;break;case fractalOption.NEWTON:canvasX=newtonDefault.CANVAS_X,canvasY=newtonDefault.CANVAS_Y,zoom=newtonDefault.ZOOM,iterations_opt.value=newtonDefault.ITERATIONS;break;default:canvasX=mandelbrotSetDefault.CANVAS_X,canvasY=mandelbrotSetDefault.CANVAS_Y,zoom=mandelbrotSetDefault.ZOOM,iterations_opt.value=mandelbrotSetDefault.ITERATIONS}}function changeTypeOptions(){switch(juliet_x_opt_container.classList.add("opt_hidden"),juliet_y_opt_container.classList.add("opt_hidden"),newton_term1_opt_container.classList.add("opt_hidden"),newton_term2_opt_container.classList.add("opt_hidden"),newton_term3_opt_container.classList.add("opt_hidden"),lyapunov_sequence_opt_container.classList.add("opt_hidden"),validity_threshold_opt_container.classList.add("opt_hidden"),type_opt.value){case fractalOption.JULIET_SET:canvasX=julietSetDefault.CANVAS_X,canvasY=julietSetDefault.CANVAS_Y,zoom=julietSetDefault.ZOOM,validity_threshold_opt_container.classList.remove("opt_hidden"),juliet_x_opt_container.classList.remove("opt_hidden"),juliet_y_opt_container.classList.remove("opt_hidden");break;case fractalOption.LYAPUNOV:canvasX=lyapunovDefault.CANVAS_X,canvasY=lyapunovDefault.CANVAS_Y,zoom=lyapunovDefault.ZOOM,lyapunov_sequence_opt_container.classList.remove("opt_hidden");break;case fractalOption.NEWTON:canvasX=newtonDefault.CANVAS_X,canvasY=newtonDefault.CANVAS_Y,zoom=newtonDefault.ZOOM,validity_threshold_opt_container.classList.remove("opt_hidden"),newton_term1_opt_container.classList.remove("opt_hidden"),newton_term2_opt_container.classList.remove("opt_hidden"),newton_term3_opt_container.classList.remove("opt_hidden");break;default:validity_threshold_opt_container.classList.remove("opt_hidden")}}function checkInMandelbrotSet(e,t){for(var o=new Complex(e,t),n=0;n<iterations_opt.value;n++)if(o=o.multiply(o),o.real+=e,o.imaginary+=t,o.imaginary>validity_threshold_opt.value||o.real>validity_threshold_opt.value||o.real*o.imaginary>validity_threshold_opt.value)return n/iterations_opt.value;return 0}function generateMandelbrotSet(){for(var e=0,t=0;t<canvas.width;t++)for(var o=0;o<canvas.height;o++)e=checkInMandelbrotSet(t/zoom-canvasX,o/zoom-canvasY),context.fillStyle=chooseColor(e),context.fillRect(t,o,1,1)}function checkInBurningShip(e,t){for(var o=new Complex(e,t),n=0;n<iterations_opt.value;n++)if(o=o.absMultiply(o),o.real+=e,o.imaginary+=t,o.imaginary>validity_threshold_opt.value||o.real>validity_threshold_opt.value||o.real*o.imaginary>validity_threshold_opt.value)return n/iterations_opt.value;return 0}function generateBurningShip(){for(var e=0,t=0;t<canvas.width;t++)for(var o=0;o<canvas.height;o++)e=checkInBurningShip(t/zoom-canvasX,o/zoom-canvasY),context.fillStyle=chooseColor(e),context.fillRect(t,o,1,1)}function checkInJulietSet(e,t,o,n){for(var a=new Complex(e,t),r=0;r<iterations_opt.value;r++){var l=a.real*a.real;if(l>validity_threshold_opt.value)return r/iterations_opt.value;var i=a.imaginary*a.imaginary;if(i>validity_threshold_opt.value||l+i>validity_threshold_opt.value)return r/iterations_opt.value;(a=a.multiply(a)).real+=o,a.imaginary+=n}return 0}function generateJulietSet(){for(var e=0,t=parseFloat(juliet_x_opt.value),o=parseFloat(juliet_y_opt.value),n=0;n<canvas.width;n++)for(var a=0;a<canvas.height;a++)e=checkInJulietSet(n/zoom-canvasX,a/zoom-canvasY,t,o),context.fillStyle=chooseColor(e),context.fillRect(n,a,1,1)}function lyapunovRFunction(e,t,o){var n=[];n.push(0);for(var a=0;a<iterations_opt.value;a++)n.push("A"===o.charAt(a)?e:t);return n}function lyapunovXFunction(e,t){var o=[];o[0]=.5;for(var n=1;n<iterations_opt.value;n++)o[n-1]===1/0||o[n-1]===-1/0?o.push(t[n]>0?-o[n-1]:o[n-1]):o.push(t[n]*o[n-1]*(1-o[n-1]));return o}function calculateLyapunovExponent(e,t,o){for(var n=lyapunovRFunction(e,t,o),e=lyapunovXFunction(o,n),a=0,r=Math.log(2),l=1;l<iterations_opt.value;l++)if((a+=Math.log(Math.abs(n[l]-2*n[l]*e[l]))/r)===1/0||a===-1/0)return a;return a/iterations_opt.value}function generateLyapunov(){for(var e=lyapunov_sequence_opt.value.repeat(iterations_opt.value),t=new Array(canvas.width),o=0,n=0,a=0;a<canvas.width;a++)t[a]=new Array(canvas.height);for(l=0;l<canvas.width;l++)for(i=0;i<canvas.height;i++)t[l][i]=calculateLyapunovExponent(l/zoom-canvasX,i/zoom-canvasY,e),t[l][i]!==1/0&&t[l][i]!==-1/0&&(t[l][i]<o?o=t[l][i]:t[l][i]>n&&(n=t[l][i]));for(var r=n-o,l=0;l<canvas.width;l++)for(var i=0;i<canvas.height;i++)t[l][i]===-1/0?error_percentage=0:t[l][i]===1/0?error_percentage=1:error_percentage=(t[l][i]-o)/r,context.fillStyle=chooseColor(error_percentage),context.fillRect(l,i,1,1)}function combineNewtonTerms(){var e={};e[newton_term1_pow_opt.value]=parseFloat(newton_term1_coef_opt.value),e[newton_term2_pow_opt.value]?e[newton_term2_pow_opt.value]=e[newton_term2_pow_opt.value]+parseFloat(newton_term2_coef_opt.value):e[newton_term2_pow_opt.value]=parseFloat(newton_term2_coef_opt.value),e[newton_term3_pow_opt.value]?e[newton_term3_pow_opt.value]=e[newton_term3_pow_opt.value]+parseFloat(newton_term3_coef_opt.value):e[newton_term3_pow_opt.value]=parseFloat(newton_term3_coef_opt.value);var t=[];for(var o in e)t.push({coef:e[o],pow:parseInt(o)});for(t.sort(function(e,t){return e.pow<t.pow?1:e.pow===t.pow?0:-1});t.length<3;)t.splice(0,0,{coef:0,pow:t[0].pow+1});newton_term1_coef_opt.value=t[0].coef,newton_term1_pow_opt.value=t[0].pow,newton_term2_coef_opt.value=t[1].coef,newton_term2_pow_opt.value=t[1].pow,newton_term3_coef_opt.value=t[2].coef,newton_term3_pow_opt.value=t[2].pow}function checkInNewton(e,t,o){for(var n=new Complex(e,t),a=new Complex(.01,.01),r=validity_threshold_opt.value/100,l=validity_threshold_opt.value,i=0;i<iterations_opt.value;i++){var _=o.complexSolve(n),c=o.complexSolve(n.add(a)).subtract(_).divide(a),u=n.subtract(_.divide(c)),p=u.subtract(n).abs();if(p<r||p>l)return i/iterations_opt.value;n=u}return 1}function generateNewton(){for(var e=0,t=new Polynomial(3,[newton_term1_coef_opt.value,newton_term2_coef_opt.value,newton_term3_coef_opt.value],[newton_term1_pow_opt.value,newton_term2_pow_opt.value,newton_term3_pow_opt.value]),o=0;o<canvas.width;o++)for(var n=0;n<canvas.height;n++)e=checkInNewton(o/zoom-canvasX,n/zoom-canvasY,t),context.fillStyle=chooseColor(e),context.fillRect(o,n,1,1)}function generateFractal(){switch(fractalLoading("LOADING..."),context.clearRect(0,0,canvas.width,canvas.height),type_opt.value){case fractalOption.MANDELBROT_SET:generateMandelbrotSet();break;case fractalOption.BURNING_SHIP:generateBurningShip();break;case fractalOption.JULIET_SET:generateJulietSet();break;case fractalOption.LYAPUNOV:generateLyapunov();break;case fractalOption.NEWTON:generateNewton()}fractalLoaded("GENERATE AND COPY LINK")}function createLink(){fractalLoading("GENERATING AND COPYING...");var e="";type_opt.value===fractalOption.JULIET_SET&&(e="&juliet_x="+juliet_x_opt.value+"&juliet_y="+juliet_y_opt.value);var t="";type_opt.value===fractalOption.LYAPUNOV&&(t="&lyapunov_sequence="+lyapunov_sequence_opt.value);var o="";type_opt.value===fractalOption.NEWTON&&(o="&newton_term1_coef="+newton_term1_coef_opt.value+"&newton_term1_pow="+newton_term1_pow_opt.value+"&newton_term2_coef="+newton_term2_coef_opt.value+"&newton_term2_pow="+newton_term2_pow_opt.value+"&newton_term3_coef="+newton_term3_coef_opt.value+"&newton_term3_pow="+newton_term3_pow_opt.value);var n=window.location.href.split("?")[0]+"?shared=1&type="+type_opt.value+"&iterations="+iterations_opt.value+"&validity_threshold="+validity_threshold_opt.value+e+t+o+"&color1="+color1_opt.value.substring(1,color1_opt.value.length)+"&color2="+color2_opt.value.substring(1,color2_opt.value.length)+"&color3="+color3_opt.value.substring(1,color3_opt.value.length)+"&color4="+color4_opt.value.substring(1,color4_opt.value.length)+"&color5="+color5_opt.value.substring(1,color5_opt.value.length)+"&x="+canvasX.toFixed(10)+"&y="+canvasY.toFixed(10)+"&zoom="+zoom.toFixed(5);link_text.value=n,link_text.select();try{document.execCommand("copy")}catch(e){alert("Use copy-and-paste to share this link")}fractalLoaded("GENERATE AND COPY LINK")}function generateRandomName(e){for(var t="",o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=0;n<e;n++)t+=o.charAt(Math.floor(Math.random()*o.length));return t}var fractalOption={MANDELBROT_SET:"1",BURNING_SHIP:"2",JULIET_SET:"3",LYAPUNOV:"4",NEWTON:"5"},mandelbrotSetDefault={CANVAS_X:2.2,CANVAS_Y:1.5,ZOOM:129.3,ITERATIONS:15},burningShipDefault={CANVAS_X:2.1,CANVAS_Y:2.1,ZOOM:120,ITERATIONS:15},julietSetDefault={CANVAS_X:1.35,CANVAS_Y:1.35,ZOOM:150,ITERATIONS:25},lyapunovDefault={CANVAS_X:-1,CANVAS_Y:-1,ZOOM:149.6,ITERATIONS:25},newtonDefault={CANVAS_X:6.7,CANVAS_Y:6.7,ZOOM:30,ITERATIONS:10},canvasX=0,canvasY=0,zoom=0,canvas=document.getElementById("fractal_canvas"),context=canvas.getContext("2d"),type_opt=document.getElementById("type_opt"),iterations_opt=document.getElementById("iterations_opt"),validity_threshold_opt_container=document.getElementById("validity_threshold_opt_container"),validity_threshold_opt=document.getElementById("validity_threshold_opt"),juliet_x_opt_container=document.getElementById("juliet_x_opt_container"),juliet_y_opt_container=document.getElementById("juliet_y_opt_container"),juliet_x_opt=document.getElementById("juliet_x_opt"),juliet_y_opt=document.getElementById("juliet_y_opt"),lyapunov_sequence_opt_container=document.getElementById("lyapunov_sequence_opt_container"),lyapunov_sequence_opt=document.getElementById("lyapunov_sequence_opt"),newton_term1_opt_container=document.getElementById("newton_term1_opt_container"),newton_term2_opt_container=document.getElementById("newton_term2_opt_container"),newton_term3_opt_container=document.getElementById("newton_term3_opt_container"),newton_term1_coef_opt=document.getElementById("newton_term1_coef_opt"),newton_term2_coef_opt=document.getElementById("newton_term2_coef_opt"),newton_term3_coef_opt=document.getElementById("newton_term3_coef_opt"),newton_term1_pow_opt=document.getElementById("newton_term1_pow_opt"),newton_term2_pow_opt=document.getElementById("newton_term2_pow_opt"),newton_term3_pow_opt=document.getElementById("newton_term3_pow_opt"),color1_opt=document.getElementById("color1_opt"),color2_opt=document.getElementById("color2_opt"),color3_opt=document.getElementById("color3_opt"),color4_opt=document.getElementById("color4_opt"),color5_opt=document.getElementById("color5_opt"),save_name=document.getElementById("save_name"),save_button=document.getElementById("save_button"),create_link_button=document.getElementById("create_link_button"),create_link_button_text=document.getElementById("create_link_button_text"),link_text=document.getElementById("link_text"),clickX=0,clickY=0,mouseDown=!1;Complex.prototype.add=function(e){return new Complex(this.real+e.real,this.imaginary+e.imaginary)},Complex.prototype.subtract=function(e){return new Complex(this.real-e.real,this.imaginary-e.imaginary)},Complex.prototype.multiply=function(e){return new Complex(this.real*e.real-this.imaginary*e.imaginary,this.real*e.imaginary+this.imaginary*e.real)},Complex.prototype.divide=function(e){var t=e.real*e.real+e.imaginary*e.imaginary;return new Complex((this.real*e.real+this.imaginary*e.imaginary)/t,(this.imaginary*e.real-this.real*e.imaginary)/t)},Complex.prototype.absMultiply=function(e){var t=Math.abs(this.real*e.imaginary),o=Math.abs(e.real*this.imaginary);return new Complex(this.real*e.real-this.imaginary*e.imaginary,t+o)},Complex.prototype.abs=function(){return Math.sqrt(this.real*this.real+this.imaginary*this.imaginary)},Polynomial.prototype.complexSolve=function(e){for(var t=[],o=0;o<this.nTerms;o++){for(var n=new Complex(1,0),a=0;a<this.pow[o];a++)n=n.multiply(e);n=n.multiply(new Complex(this.coef[o],0)),t.push(n)}for(var r=t[0],l=1;l<t.length;l++)r=r.add(t[l]);return r},function(e){"use strict";var t,o=e.Uint8Array,n=e.HTMLCanvasElement,a=n&&n.prototype,r=/\s*;\s*base64\s*(?:;|$)/i,l="toDataURL",i=function(e){for(var n,a,r=e.length,l=new o(r/4*3|0),i=0,_=0,c=[0,0],u=0,p=0;r--;)a=e.charCodeAt(i++),255!==(n=t[a-43])&&void 0!==n&&(c[1]=c[0],c[0]=a,p=p<<6|n,4==++u&&(l[_++]=p>>>16,61!==c[1]&&(l[_++]=p>>>8),61!==c[0]&&(l[_++]=p),u=0));return l};o&&(t=new o([62,-1,-1,-1,63,52,53,54,55,56,57,58,59,60,61,-1,-1,-1,0,-1,-1,-1,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,-1,-1,-1,-1,-1,-1,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51])),!n||a.toBlob&&a.toBlobHD||(a.toBlob||(a.toBlob=function(e,t){if(t||(t="image/png"),this.mozGetAsFile)e(this.mozGetAsFile("canvas",t));else if(this.msToBlob&&/^\s*image\/png\s*(?:$|;)/i.test(t))e(this.msToBlob());else{var n,a=Array.prototype.slice.call(arguments,1),_=this[l].apply(this,a),c=_.indexOf(","),u=_.substring(c+1),p=r.test(_.substring(0,c));Blob.fake?((n=new Blob).encoding=p?"base64":"URI",n.data=u,n.size=u.length):o&&(n=p?new Blob([i(u)],{type:t}):new Blob([decodeURIComponent(u)],{type:t})),e(n)}}),!a.toBlobHD&&a.toDataURLHD?a.toBlobHD=function(){l="toDataURLHD";var e=this.toBlob();return l="toDataURL",e}:a.toBlobHD=a.toBlob)}("undefined"!=typeof self&&self||"undefined"!=typeof window&&window||this.content||this);var saveAs=saveAs||function(e){"use strict";if(!(void 0===e||"undefined"!=typeof navigator&&/MSIE [1-9]\./.test(navigator.userAgent))){var t=function(){return e.URL||e.webkitURL||e},o=e.document.createElementNS("http://www.w3.org/1999/xhtml","a"),n="download"in o,a=function(e){var t=new MouseEvent("click");e.dispatchEvent(t)},r=/constructor/i.test(e.HTMLElement)||e.safari,l=/CriOS\/[\d]+/.test(navigator.userAgent),i=function(t){(e.setImmediate||e.setTimeout)(function(){throw t},0)},_=function(e){setTimeout(function(){"string"==typeof e?t().revokeObjectURL(e):e.remove()},4e4)},c=function(e,t,o){for(var n=(t=[].concat(t)).length;n--;){var a=e["on"+t[n]];if("function"==typeof a)try{a.call(e,o||e)}catch(e){i(e)}}},u=function(e){return/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(e.type)?new Blob([String.fromCharCode(65279),e],{type:e.type}):e},p=function(i,p,s){s||(i=u(i));var v,m=this,d="application/octet-stream"===i.type,f=function(){c(m,"writestart progress write writeend".split(" "))};if(m.readyState=m.INIT,n)return v=t().createObjectURL(i),void setTimeout(function(){o.href=v,o.download=p,a(o),f(),_(v),m.readyState=m.DONE});!function(){if((l||d&&r)&&e.FileReader){var o=new FileReader;return o.onloadend=function(){var t=l?o.result:o.result.replace(/^data:[^;]*;/,"data:attachment/file;");e.open(t,"_blank")||(e.location.href=t),t=void 0,m.readyState=m.DONE,f()},o.readAsDataURL(i),void(m.readyState=m.INIT)}v||(v=t().createObjectURL(i)),d?e.location.href=v:e.open(v,"_blank")||(e.location.href=v),m.readyState=m.DONE,f(),_(v)}()},s=p.prototype;return"undefined"!=typeof navigator&&navigator.msSaveOrOpenBlob?function(e,t,o){return t=t||e.name||"download",o||(e=u(e)),navigator.msSaveOrOpenBlob(e,t)}:(s.abort=function(){},s.readyState=s.INIT=0,s.WRITING=1,s.DONE=2,s.error=s.onwritestart=s.onprogress=s.onwrite=s.onabort=s.onerror=s.onwriteend=null,function(e,t,o){return new p(e,t||e.name||"download",o)})}}("undefined"!=typeof self&&self||"undefined"!=typeof window&&window||this.content);"undefined"!=typeof module&&module.exports?module.exports.saveAs=saveAs:"undefined"!=typeof define&&null!==define&&null!==define.amd&&define("FileSaver.js",function(){return saveAs}),type_opt.addEventListener("focus",function(e){fractalLoading("LOADING...")}),type_opt.addEventListener("focusout",function(e){fractalUnload("GENERATE AND COPY LINK")}),type_opt.onchange=function(){selectDefaults(),combineNewtonTerms(),changeTypeOptions(),generateFractal()},iterations_opt.onchange=function(){iterations_opt.value<1?iterations_opt.value=1:iterations_opt.value>2e3&&(iterations_opt.value=2e3),iterations_opt.value=Math.round(iterations_opt.value),generateFractal()},validity_threshold_opt.onchange=function(){validity_threshold_opt.value<1?validity_threshold_opt.value=1:validity_threshold_opt.value>1e3&&(validity_threshold_opt.value=1e3),validity_threshold_opt.value=Math.round(validity_threshold_opt.value),generateFractal()},juliet_x_opt.onchange=function(){juliet_x_opt.value<-1.7?juliet_x_opt.value=-1.7:juliet_x_opt.value>.7&&(juliet_x_opt.value=.7),juliet_x_opt.value=Math.round(1e3*juliet_x_opt.value)/1e3,generateFractal()},juliet_y_opt.onchange=function(){juliet_y_opt.value<-1?juliet_y_opt.value=-1:juliet_y_opt.value>1&&(juliet_y_opt.value=1),juliet_y_opt.value=Math.round(1e3*juliet_y_opt.value)/1e3,generateFractal()},lyapunov_sequence_opt.onchange=function(){lyapunov_sequence_opt.value=lyapunov_sequence_opt.value.toUpperCase().replace(/[^AB]/g,""),""===lyapunov_sequence_opt.value&&(lyapunov_sequence_opt.value="AABABBB"),generateFractal()},newton_term1_coef_opt.onchange=function(){newton_term1_coef_opt.value=Math.round(1e3*newton_term1_coef_opt.value)/1e3,combineNewtonTerms(),generateFractal()},newton_term2_coef_opt.onchange=function(){newton_term2_coef_opt.value=Math.round(1e3*newton_term2_coef_opt.value)/1e3,combineNewtonTerms(),generateFractal()},newton_term3_coef_opt.onchange=function(){0===newton_term3_coef_opt.value&&(newton_term3_coef_opt.value=1),newton_term3_coef_opt.value=Math.round(1e3*newton_term3_coef_opt.value)/1e3,combineNewtonTerms(),generateFractal()},newton_term1_pow_opt.onchange=function(){newton_term1_pow_opt.value<0&&(newton_term1_pow_opt.value=0),newton_term1_pow_opt.value=Math.round(newton_term1_pow_opt.value),combineNewtonTerms(),generateFractal()},newton_term2_pow_opt.onchange=function(){newton_term2_pow_opt.value<0&&(newton_term2_pow_opt.value=0),newton_term2_pow_opt.value=Math.round(newton_term2_pow_opt.value),combineNewtonTerms(),generateFractal()},newton_term3_pow_opt.onchange=function(){newton_term3_pow_opt.value<0&&(newton_term3_pow_opt.value=0),newton_term3_pow_opt.value=Math.round(newton_term3_pow_opt.value),combineNewtonTerms(),generateFractal()},color1_opt.onchange=function(){generateFractal()},color2_opt.onchange=function(){generateFractal()},color3_opt.onchange=function(){generateFractal()},color4_opt.onchange=function(){generateFractal()},color5_opt.onchange=function(){generateFractal()},canvas.addEventListener("mousedown",function(e){0===e.button&&(fractalLoading("LOADING..."),mouseDown=!0)}),canvas.addEventListener("mouseup",function(e){0===e.button&&(generateFractal(),mouseDown=!1)}),canvas.addEventListener("mousemove",function(e){mouseDown?moveCanvas(e):(clickX=e.clientX,clickY=e.clientY)}),canvas.addEventListener("mousewheel",debounce(300,function(e){for(var t=0,o=0;o<this.data.length;++o)t+=this.data[o][0].wheelDelta>=0?1:-1;zoomCanvas(t),generateFractal()},!0)),canvas.addEventListener("DOMMouseScroll",debounce(200,function(e){for(var t=0,o=0;o<this.data.length;++o)t+=-this.data[o][0].detail>=0?1:-1;zoomCanvas(t),generateFractal()},!0)),create_link_button.onclick=function(){createLink()},save_button.onclick=function(){var e;0===save_name.value.length?e=generateRandomName(Math.floor(12*Math.random()+5)):0===(e=save_name.value.replace(/[^a-z0-9]/gi,"_").replace(/^_+|\_+$/g,"").replace(/_{2,}/g,"_").toLowerCase()).length&&(e=generateRandomName(Math.floor(12*Math.random()+5))),canvas.toBlob(function(t){saveAs(t,e+".png")})},getURLParameter("shared")?(type_opt.value=getURLParameter("type"),changeTypeOptions(),iterations_opt.value=parseInt(getURLParameter("iterations")),validity_threshold_opt.value=parseInt(getURLParameter("validity_threshold")),type_opt.value===fractalOption.JULIET_SET?(juliet_x_opt.value=parseFloat(getURLParameter("juliet_x")),juliet_y_opt.value=parseFloat(getURLParameter("juliet_y"))):type_opt.value===fractalOption.LYAPUNOV?lyapunov_sequence_opt.value=getURLParameter("lyapunov_sequence"):type_opt.value===fractalOption.NEWTON&&(newton_term1_coef_opt.value=parseFloat(getURLParameter("newton_term1_coef")),newton_term2_coef_opt.value=parseFloat(getURLParameter("newton_term2_coef")),newton_term3_coef_opt.value=parseFloat(getURLParameter("newton_term3_coef")),newton_term1_pow_opt.value=parseInt(getURLParameter("newton_term1_pow")),newton_term2_pow_opt.value=parseInt(getURLParameter("newton_term2_pow")),newton_term3_pow_opt.value=parseInt(getURLParameter("newton_term3_pow")),combineNewtonTerms()),color1_opt.value="#"+getURLParameter("color1"),color2_opt.value="#"+getURLParameter("color2"),color3_opt.value="#"+getURLParameter("color3"),color4_opt.value="#"+getURLParameter("color4"),color5_opt.value="#"+getURLParameter("color5"),canvasX=parseFloat(getURLParameter("x")),canvasY=parseFloat(getURLParameter("y")),zoom=parseFloat(getURLParameter("zoom"))):(selectDefaults(),changeTypeOptions()),generateFractal();